"use strict";(self.webpackChunkunivesp_task_manager_spa=self.webpackChunkunivesp_task_manager_spa||[]).push([[551],{3551:(te,k,c)=>{c.r(k),c.d(k,{ProjectsModule:()=>Kt});var h=c(6814),A=c(7081),F=c(2019),g=c(1896),t=c(5879);const et=[];let ot=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(et),g.Bz]})}return e})(),it=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[h.ez,ot,A.q,F.m]})}return e})();var p=c(7700),u=c(6223);class T{constructor(n){Object.assign(this,n)}}var U=c(4516),f=c(9157),I=c(6263),d=c(3814);function at(e,n){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Nome \xe9 obrigat\xf3rio "),t.qZA())}function nt(e,n){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Tempo estimado deve ser maior que 0 "),t.qZA())}let D=(()=>{class e{constructor(o){this.formBuilder=o,this.data=new T,this.submitedEvent=new t.vpe,console.log("ProjectFormComponent Constructor")}ngOnInit(){this.projectFormGroup=this.formBuilder.group({name:[this.data.name,u.kI.required],description:[this.data.description],estimated_duration:[this.data.estimated_duration,u.kI.min(0)]})}isFormValid(){return this.projectFormGroup.valid}getFormValue(){return this.projectFormGroup.value}onSubmit(){this.isFormValid()&&this.submitedEvent.emit(this.projectFormGroup.value)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(u.qu))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-project-form"]],inputs:{data:"data"},outputs:{submitedEvent:"submitedEvent"},decls:26,vars:3,consts:[[1,"container"],[3,"formGroup","keydown.enter"],["fxLayout","","fxLayout.xs","column","fxLayoutAlign","start","fxLayoutGap","10px",1,"container"],["fxFlex","100%"],["matInput","","placeholder","Nome","formControlName","name","required","","autofocus",""],["name",""],[1,"mat-caption"],[4,"ngIf"],["fxLayout","","fxLayout.xs","column","fxlayoutAlign","start start","fxLayoutGap","30px",1,"container"],["fxFlex","","fxFlexAlign","center"],["matInput","","placeholder","Descri\xe7\xe3o","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","7","cdkAutosizeMaxRows","10"],["description","","autosize","cdkTextareaAutosize"],["matInput","","placeholder","Tempo estimado para conclus\xe3o","formControlName","estimated_duration","type","number","min","0"]],template:function(a,i){if(1&a&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("keydown.enter",function(){return i.onSubmit()}),t.TgZ(2,"div",2)(3,"div",3)(4,"mat-form-field"),t._UZ(5,"input",4,5),t.TgZ(7,"mat-hint",6),t._uU(8," Nome do Projeto "),t.qZA(),t.YNc(9,at,2,0,"mat-error",7),t.qZA()()(),t.TgZ(10,"div",8)(11,"div",9)(12,"mat-form-field"),t._UZ(13,"textarea",10,11),t.TgZ(16,"mat-hint",6),t._uU(17," Descri\xe7\xe3o "),t.qZA()()()(),t.TgZ(18,"div",2)(19,"div",3)(20,"mat-form-field"),t._UZ(21,"input",12,5),t.TgZ(23,"mat-hint",6),t._uU(24,"Tempo estimado em minutos "),t.qZA(),t.YNc(25,nt,2,0,"mat-error",7),t.qZA()()()()()),2&a){let r,s;t.xp6(1),t.Q6J("formGroup",i.projectFormGroup),t.xp6(8),t.Q6J("ngIf",null==i.projectFormGroup||null==(r=i.projectFormGroup.get("name"))?null:r.hasError("required")),t.xp6(16),t.Q6J("ngIf",null==i.projectFormGroup||null==(s=i.projectFormGroup.get("estimated_duration"))?null:s.hasError("min"))}},dependencies:[h.O5,U.Nt,f.KE,f.bx,f.TO,I.IC,d.xw,d.SQ,d.Wh,d.XD,d.yH,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.Q7,u.qQ,u.sg,u.u],styles:[".container[_ngcontent-%COMP%]{margin-bottom:10px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}"]})}return e})();var Z=c(2296);let N=(()=>{class e{constructor(o,a,i){this.dialogRef=o,this.data=a,this.cdr=i,this.dialogAction="Adicionar",a.id&&(this.dialogAction=`Editar #${a.id}`)}isFormValid(){return this.form?.isFormValid()??!1}getFormValue(){return this.form?.getFormValue()}closeDialog(o){this.dialogRef.close(o)}ngAfterViewChecked(){this.cdr.detectChanges()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(p.so),t.Y36(p.WI),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-project-form-dialog"]],viewQuery:function(a,i){if(1&a&&t.Gf(D,5),2&a){let r;t.iGM(r=t.CRH())&&(i.form=r.first)}},inputs:{dialogAction:"dialogAction"},decls:9,vars:4,consts:[["mat-dialog-title",""],[3,"data","submitedEvent"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled"]],template:function(a,i){1&a&&(t.TgZ(0,"p",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"app-project-form",1),t.NdJ("submitedEvent",function(s){return i.closeDialog(s)}),t.qZA()(),t.TgZ(4,"mat-dialog-actions")(5,"button",2),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"button",3),t._uU(8," Salvar "),t.qZA()()),2&a&&(t.xp6(1),t.hij(" ",i.dialogAction,"\n"),t.xp6(2),t.Q6J("data",i.data),t.xp6(4),t.Q6J("mat-dialog-close",i.getFormValue())("disabled",!i.isFormValid()))},dependencies:[Z.lW,p.ZT,p.uh,p.xY,p.H8,D]})}return e})();var v=c(3365),_=c(3566),l=c(5313),j=c(9397),P=c(4974),E=c(8337),C=c(5619),q=c(6306),Y=c(2096),G=c(4716);class rt extends E.o2{constructor(n){super(),this.projectService=n,this.projectsSubject=new C.X([]),this.loadingSubject=new C.X(!1),this.loading$=this.loadingSubject.asObservable(),this.count=0}connect(n){return this.projectsSubject.asObservable()}disconnect(n){this.projectsSubject.complete(),this.loadingSubject.complete()}load(n){this.loadingSubject.next(!0),this.projectService.paginate(n).pipe((0,q.K)(()=>(0,Y.of)([])),(0,G.x)(()=>this.loadingSubject.next(!1))).subscribe(o=>{this.count=o.meta.total,this.projectsSubject.next(o.data)})}getCount(){return this.count}}var Q=c(9862),O=c(7398),R=c(553),S=c(5263);let y=(()=>{class e{constructor(o){this.apiService=o,this.resourceUrl=`${R.N.apiBaseUrl}/projects`}paginate(o){const a=(new Q.LE).set("filter",o?.filter??"").set("sortColumn",o?.sortColumn??"id").set("sortOrder",o?.sortOrder??"asc").set("page",o?.page?.toString()??"1").set("per_page",o?.limit?.toString()??"10");return this.apiService.getRequest(this.resourceUrl,a)}getById(o){return this.apiService.getById(this.resourceUrl,o).pipe((0,O.U)(a=>new T(a.data)))}create(o){return this.apiService.postRequest(this.getResourceUrl(),o)}update(o,a){const i=`${this.getResourceUrl()}/${o}`;return console.log(i),this.apiService.patchRequest(i,a)}getResourceUrl(){return this.resourceUrl}static#t=this.\u0275fac=function(a){return new(a||e)(t.LFG(S.sM))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var J=c(617),M=c(3448),w=c(5860);function st(e,n){1&e&&(t.TgZ(0,"th",15),t._uU(1,"#"),t.qZA())}function ct(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.id)}}function lt(e,n){1&e&&(t.TgZ(0,"th",15),t._uU(1,"Nome"),t.qZA())}function ut(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.name)}}function dt(e,n){1&e&&(t.TgZ(0,"th",15),t._uU(1,"Descri\xe7\xe3o"),t.qZA())}function pt(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.description)}}function mt(e,n){1&e&&(t.TgZ(0,"th",15),t._uU(1," Dura\xe7\xe3o Estimada "),t.qZA())}function ft(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.estimated_duration?o.estimated_duration+" minutos":"N\xe3o informado"," ")}}function ht(e,n){1&e&&(t.TgZ(0,"th",15),t._uU(1,"Descri\xe7\xe3o"),t.qZA())}function gt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(o);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openEditDialog(i))}),t.TgZ(1,"mat-icon",18),t._uU(2,"edit"),t.qZA(),t._uU(3,"Editar "),t.qZA()}}function _t(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",16)(1,"button",17),t.NdJ("click",function(){const r=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.open(r))}),t.TgZ(2,"mat-icon",18),t._uU(3,"launch"),t.qZA(),t._uU(4,"Abrir "),t.qZA(),t.YNc(5,gt,4,0,"button",19),t.qZA()}if(2&e){const o=n.$implicit;t.xp6(5),t.Q6J("ngIf",!o.deleted_at)}}function Tt(e,n){1&e&&t._UZ(0,"tr",20)}function Ct(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"tr",21),t.NdJ("dblclick",function(){const r=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.onRowDoubleClick(r))}),t.qZA()}}let L=(()=>{class e{constructor(o,a,i){this.projectService=o,this.dialog=a,this.router=i,this.pageSizeOptions=[1,10,25,50,100],this.filter="",this.displayedColumns=["id","name","description","estimated_duration","actions"],this.dataSource=new rt(this.projectService),this.dataSource.load()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.table.dataSource=this.dataSource,this.sort.sortChange.subscribe(()=>this.resetPaginator()),this.paginator.page.pipe((0,j.b)(()=>this.load())).subscribe(),this.sort.sortChange.pipe((0,j.b)(()=>this.load())).subscribe()}load(){this.dataSource.load({filter:this.filter,sortColumn:this.sort.active,sortOrder:this.sort.direction,page:this.paginator.pageIndex+1,limit:this.paginator.pageSize})}search(o){this.resetPaginator(),this.filter=o,this.load()}onRowDoubleClick(o){this.open(o)}open(o){this.router.navigate(["/projects",o.id])}openEditDialog(o){this.dialog.open(N,{width:"720px",data:o}).afterClosed().subscribe(i=>{i&&this.projectService.update(o.id.toString(),i).subscribe(r=>{this.load()})})}resetPaginator(){this.paginator.pageIndex=0}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(y),t.Y36(p.uw),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-project-table"]],viewQuery:function(a,i){if(1&a&&(t.Gf(v.NW,5),t.Gf(_.YE,5),t.Gf(l.BZ,5),t.Gf(P.g5,5)),2&a){let r;t.iGM(r=t.CRH())&&(i.paginator=r.first),t.iGM(r=t.CRH())&&(i.sort=r.first),t.iGM(r=t.CRH())&&(i.table=r.first),t.iGM(r=t.CRH())&&(i.tableSearchField=r.first)}},decls:24,vars:7,consts:[[1,"container"],[3,"loading$"],["hint","Insira o nome do projeto que deseja localizar",3,"search"],["mat-table","","matSort","","aria-label","Elements",1,"mat-elevation-z8","full-width-table"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","estimated_duration"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"dblclick",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",1,"mat-elevation-z8",3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-button","","color","primary",3,"click"],["matSuffix",""],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-header-row",""],["mat-row","",3,"dblclick"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0),t._UZ(1,"app-loading-spinner",1),t.TgZ(2,"app-table-search-field",2),t.NdJ("search",function(s){return i.search(s)}),t.qZA(),t.TgZ(3,"table",3),t.ynx(4,4),t.YNc(5,st,2,0,"th",5),t.YNc(6,ct,2,1,"td",6),t.BQk(),t.ynx(7,7),t.YNc(8,lt,2,0,"th",5),t.YNc(9,ut,2,1,"td",6),t.BQk(),t.ynx(10,8),t.YNc(11,dt,2,0,"th",5),t.YNc(12,pt,2,1,"td",6),t.BQk(),t.ynx(13,9),t.YNc(14,mt,2,0,"th",5),t.YNc(15,ft,2,1,"td",6),t.BQk(),t.ynx(16,10),t._UZ(17,"th"),t.YNc(18,ht,2,0,"th",5),t.YNc(19,_t,6,1,"td",6),t.BQk(),t.YNc(20,Tt,1,0,"tr",11),t.YNc(21,Ct,1,0,"tr",12),t.qZA(),t._UZ(22,"mat-paginator",13,14),t.qZA()),2&a&&(t.xp6(1),t.Q6J("loading$",i.dataSource.loading$),t.xp6(19),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.dataSource.getCount())("pageIndex",0)("pageSize",10)("pageSizeOptions",i.pageSizeOptions))},dependencies:[h.O5,Z.lW,J.Hw,f.R9,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,v.NW,_.YE,_.nU,M.g,w.g],styles:[".container[_ngcontent-%COMP%]{padding-top:20px}.full-width-table[_ngcontent-%COMP%]{width:96%;margin:20px auto 0}mat-paginator[_ngcontent-%COMP%]{width:100%;margin:0 auto 20px}.mat-column-id[_ngcontent-%COMP%]{width:75px}.mat-column-actions[_ngcontent-%COMP%]{min-width:130px}.mat-column-description[_ngcontent-%COMP%]{min-width:250px}"]})}return e})();var m=c(5195),B=c(1878);let bt=(()=>{class e{constructor(o,a){this.projectService=o,this.dialog=a,this.addButtonLabel="Adicionar Projeto",this.project=new T}openCreateDialog(){console.log("openCreateDialog"),this.dialog.open(N,{width:"720px",data:this.project}).afterClosed().subscribe(a=>{a?.name&&this.projectService.create(a).subscribe(i=>{this.project=new T,this.table.load()})})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(y),t.Y36(p.uw))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-project-list"]],viewQuery:function(a,i){if(1&a&&t.Gf(L,5),2&a){let r;t.iGM(r=t.CRH())&&(i.table=r.first)}},decls:13,vars:1,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutAlign","center","fxLayoutGap","10px","fxLayoutGap.xs","5px",1,"container"],["fxFlex.gt-md","65","fxFlex.md","80","fxFlex","90"],["fxLayout","row"],["fxFlex","20%"],[3,"buttonLabel","click"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-card")(3,"mat-card-header")(4,"mat-card-title"),t._uU(5,"Lista de Projetos"),t.qZA(),t.TgZ(6,"mat-card-subtitle"),t._uU(7,"Gerenciamento de Projetos"),t.qZA()(),t.TgZ(8,"mat-card-content")(9,"div",2)(10,"div",3)(11,"app-add-button",4),t.NdJ("click",function(){return i.openCreateDialog()}),t.qZA()()(),t._UZ(12,"app-project-table"),t.qZA()()()()),2&a&&(t.xp6(11),t.Q6J("buttonLabel",i.addButtonLabel))},dependencies:[m.a8,m.dn,m.dk,m.$j,m.n5,d.xw,d.SQ,d.Wh,d.yH,B.L,L],styles:["mat-card-content[_ngcontent-%COMP%]{margin-top:20px}"]})}return e})();var b=function(e){return e[e.New=1]="New",e[e.InProgress=2]="InProgress",e[e.Done=3]="Done",e}(b||{}),z=function(e){return e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.Urgent=4]="Urgent",e}(z||{});class x{constructor(n){this.completed=!1,this.priority_id=z.Medium,this.status_id=b.New,Object.assign(this,n)}}var $=c(7861),H=c(5631),V=c(1437);function xt(e,n){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Dura\xe7\xe3o deve ser maior que 0 "),t.qZA())}function Zt(e,n){1&e&&(t.TgZ(0,"mat-error"),t._uU(1," Nome \xe9 obrigat\xf3rio "),t.qZA())}let X=(()=>{class e{constructor(o){this.formBuilder=o,this.data=new x,this.submitedEvent=new t.vpe}ngOnInit(){this.taskFormGroup=this.formBuilder.group({name:[this.data.name,u.kI.required],description:[this.data.description],effective_duration:[this.data.effective_duration,u.kI.min(0)],priority_id:[this.data.priority_id],status_id:[this.data.status_id],user_id:[this.data.user_id]})}ngAfterViewInit(){}isFormValid(){return this.taskFormGroup.valid}getFormValue(){return this.taskFormGroup.value}onSubmit(){this.isFormValid()&&this.submitedEvent.emit(this.taskFormGroup.value)}userSelected(o){this.taskFormGroup.controls.user_id.setValue(o.value)}prioritySelected(o){this.taskFormGroup.controls.priority_id.setValue(o.value)}statusSelected(o){this.taskFormGroup.controls.status_id.setValue(o.value)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(u.qu))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-task-form"]],inputs:{data:"data"},outputs:{submitedEvent:"submitedEvent"},decls:32,vars:9,consts:[[3,"formGroup","keydown.enter"],["fxLayout","row","fxLayoutAlign","start start","fxLayoutGap","30px",1,"container"],["fxFlex","100%","fxFlexFill",""],[3,"value","required","selectionChange"],["fxFlex","30%","fxFlexFill",""],["fxFlex","40%"],["matInput","","placeholder","Dura\xe7\xe3o Efetiva","formControlName","effective_duration","type","number","min","0"],["effective_duration",""],[1,"mat-caption"],[4,"ngIf"],["matInput","","placeholder","Nome","formControlName","name","cdkFocusInitial",""],["name",""],["matInput","","placeholder","Descri\xe7\xe3o","formControlName","description","cdkTextareaAutosize","","cdkAutosizeMinRows","7","cdkAutosizeMaxRows","10"],["description","","autosize","cdkTextareaAutosize"]],template:function(a,i){if(1&a&&(t.TgZ(0,"form",0),t.NdJ("keydown.enter",function(){return i.onSubmit()}),t.TgZ(1,"div",1)(2,"div",2)(3,"app-user-select",3),t.NdJ("selectionChange",function(s){return i.userSelected(s)}),t.qZA()()(),t.TgZ(4,"div",1)(5,"div",4)(6,"app-priority-select",3),t.NdJ("selectionChange",function(s){return i.prioritySelected(s)}),t.qZA()(),t.TgZ(7,"div",4)(8,"app-status-select",3),t.NdJ("selectionChange",function(s){return i.statusSelected(s)}),t.qZA()(),t.TgZ(9,"div",5)(10,"mat-form-field"),t._UZ(11,"input",6,7),t.TgZ(13,"mat-hint",8),t._uU(14,"Tempo estimado em minutos "),t.qZA(),t.YNc(15,xt,2,0,"mat-error",9),t.qZA()()(),t.TgZ(16,"div",1)(17,"div",2)(18,"mat-form-field"),t._UZ(19,"input",10,11),t.TgZ(21,"mat-hint",8),t._uU(22,"Nome da Tarefa"),t.qZA(),t.YNc(23,Zt,2,0,"mat-error",9),t.qZA()()(),t.TgZ(24,"div",1)(25,"div",2)(26,"mat-form-field"),t._UZ(27,"textarea",12,13),t.TgZ(30,"mat-hint",8),t._uU(31,"Descri\xe7\xe3o"),t.qZA()()()()()),2&a){let r,s;t.Q6J("formGroup",i.taskFormGroup),t.xp6(3),t.Q6J("value",i.data.user_id)("required",!0),t.xp6(3),t.Q6J("value",i.data.priority_id)("required",!0),t.xp6(2),t.Q6J("value",i.data.status_id)("required",!0),t.xp6(7),t.Q6J("ngIf",null==i.taskFormGroup||null==(r=i.taskFormGroup.get("effective_duration"))?null:r.hasError("min")),t.xp6(8),t.Q6J("ngIf",null==i.taskFormGroup||null==(s=i.taskFormGroup.get("name"))?null:s.hasError("required"))}},dependencies:[h.O5,U.Nt,f.KE,f.bx,f.TO,I.IC,d.xw,d.SQ,d.Wh,d.s9,d.yH,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.qQ,u.sg,u.u,$.k,H.p,V.q],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{margin-bottom:15px}"]})}return e})(),W=(()=>{class e{constructor(o,a,i){this.dialogRef=o,this.data=a,this.cdr=i,this.dialogAction="Adicionar",a.id&&(this.dialogAction=`Editar #${a.id}`)}isFormValid(){return this.form?.isFormValid()??!1}getFormValue(){return this.form?.getFormValue()}closeDialog(o){this.dialogRef.close(o)}ngAfterViewChecked(){this.cdr.detectChanges()}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(p.so),t.Y36(p.WI),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-task-form-dialog"]],viewQuery:function(a,i){if(1&a&&t.Gf(X,5),2&a){let r;t.iGM(r=t.CRH())&&(i.form=r.first)}},inputs:{dialogAction:"dialogAction"},decls:9,vars:4,consts:[["mat-dialog-title",""],[3,"data","submitedEvent"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"mat-dialog-close","disabled"]],template:function(a,i){1&a&&(t.TgZ(0,"p",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content")(3,"app-task-form",1),t.NdJ("submitedEvent",function(s){return i.closeDialog(s)}),t.qZA()(),t.TgZ(4,"mat-dialog-actions")(5,"button",2),t._uU(6,"Cancelar"),t.qZA(),t.TgZ(7,"button",3),t._uU(8," Salvar "),t.qZA()()),2&a&&(t.xp6(1),t.hij(" ",i.dialogAction,"\n"),t.xp6(2),t.Q6J("data",i.data),t.xp6(4),t.Q6J("mat-dialog-close",i.getFormValue())("disabled",!i.isFormValid()))},dependencies:[Z.lW,p.ZT,p.uh,p.xY,p.H8,X]})}return e})();class vt extends E.o2{constructor(n){super(),this.taskService=n,this.tasksSubject=new C.X([]),this.loadingSubject=new C.X(!1),this.loading$=this.loadingSubject.asObservable(),this.count=0}connect(n){return this.tasksSubject.asObservable()}disconnect(n){this.tasksSubject.complete(),this.loadingSubject.complete()}load(n){this.loadingSubject.next(!0),this.taskService.paginate(n).pipe((0,q.K)(()=>(0,Y.of)([])),(0,G.x)(()=>this.loadingSubject.next(!1))).subscribe(o=>{this.count=o.meta.total,this.tasksSubject.next(o.data)})}getCount(){return this.count}getTotalEffectiveDuration(){return this.tasksSubject.value.reduce((n,o)=>n+(o.effective_duration||0),0)}}let K=(()=>{class e{constructor(o){this.apiService=o,this.resourceUrl=`${R.N.apiBaseUrl}/tasks`}paginate(o){let a=(new Q.LE).set("filter",o?.filter??"").set("sortColumn",o?.sortColumn??"id").set("sortOrder",o?.sortOrder??"asc").set("page",o?.page?.toString()??"1").set("per_page",o?.limit?.toString()??"10").set("project_id",o?.projectId?.toString()??"").set("priority_id",o?.priorityId?.toString()??"").set("status_id",o?.statusId?.toString()??"").set("user_id",o?.userId?.toString()??"");return this.apiService.getRequest(this.resourceUrl,a)}getById(o){return this.apiService.getById(this.resourceUrl,o).pipe((0,O.U)(a=>new x(a.data)))}create(o){return this.apiService.postRequest(this.getResourceUrl(),o)}update(o,a){const i=`${this.getResourceUrl()}/${o}`;return console.log(i),this.apiService.patchRequest(i,a)}getResourceUrl(){return this.resourceUrl}static#t=this.\u0275fac=function(a){return new(a||e)(t.LFG(S.sM))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var jt=c(5986);function St(e,n){1&e&&t._UZ(0,"th",23)}function yt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",24)(1,"mat-checkbox",25),t.NdJ("click",function(){const r=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.toggle(r))}),t.qZA()()}if(2&e){const o=n.$implicit;t.xp6(1),t.s9C("checked",3==o.status_id?"true":"false")}}function wt(e,n){1&e&&(t.TgZ(0,"td",26),t._uU(1," Dura\xe7\xe3o Efetiva Total "),t.qZA())}function kt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"#"),t.qZA())}function At(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.id)}}function Ft(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Nome"),t.qZA())}function Ut(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.name)}}function It(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Descri\xe7\xe3o"),t.qZA())}function Dt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.description)}}function Nt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Status"),t.qZA())}function Pt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.status.name)}}function Et(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Prioridade"),t.qZA())}function qt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Oqu(o.priority.name)}}function Yt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Usu\xe1rio"),t.qZA())}function Gt(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.user.name," ")}}function Qt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Dura\xe7\xe3o Efetiva"),t.qZA())}function Ot(e,n){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.effective_duration?o.effective_duration+" minutos":"N\xe3o informado"," ")}}function Rt(e,n){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij(" ",o.getTotalEffectiveDuration()," ")}}function Jt(e,n){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Descri\xe7\xe3o"),t.qZA())}function Mt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(o);const i=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openEditDialog(i))}),t.TgZ(1,"mat-icon",31),t._uU(2,"edit"),t.qZA(),t._uU(3,"Editar "),t.qZA()}}function Lt(e,n){if(1&e&&(t.TgZ(0,"td",24),t.YNc(1,Mt,4,0,"button",29),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.Q6J("ngIf",!o.deleted_at)}}function Bt(e,n){1&e&&t._UZ(0,"tr",32)}function zt(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"tr",33),t.NdJ("dblclick",function(){const r=t.CHM(o).$implicit,s=t.oxw();return t.KtG(s.onRowDoubleClick(r))}),t.qZA()}}function $t(e,n){1&e&&t._UZ(0,"tr",34)}let tt=(()=>{class e{constructor(o,a,i){this.taskService=o,this.dialog=a,this.router=i,this.pageSizeOptions=[1,10,25,50,100],this.filter="",this.displayedColumns=["checkbox","id","name","status_id","priority_id","user_id","effective_duration","actions"],this.displayedColumnsFooter=["checkbox","effective_duration"],this.dataSource=new vt(this.taskService)}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.table.dataSource=this.dataSource,this.sort.sortChange.subscribe(()=>this.resetPaginator()),this.paginator.page.pipe((0,j.b)(()=>this.load())).subscribe(),this.sort.sortChange.pipe((0,j.b)(()=>this.load())).subscribe()}ngOnChanges(){this.projectId&&this.load()}load(){this.dataSource.load({filter:this.filter,sortColumn:this.sort.active,sortOrder:this.sort.direction,page:this.paginator.pageIndex+1,limit:this.paginator.pageSize,projectId:this.projectId||null,userId:this.userId||null,statusId:this.statusId||null,priorityId:this.priorityId||null})}search(o){this.resetPaginator(),this.filter=o,this.load()}onRowDoubleClick(o){this.openEditDialog(o)}toggle(o){o.status_id=o.status_id===b.Done?b.InProgress:b.Done,this.taskService.update(o.id.toString(),o).subscribe(a=>{this.load()})}openEditDialog(o){this.dialog.open(W,{width:"800px",data:o}).afterClosed().subscribe(i=>{i&&this.taskService.update(o.id.toString(),i).subscribe(r=>{this.load()})})}getTotalEffectiveDuration(){const o=this.dataSource.getTotalEffectiveDuration();return`${Math.floor(o/60)}h ${o%60}m`}resetPaginator(){this.paginator.pageIndex=0}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(K),t.Y36(p.uw),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-task-table"]],viewQuery:function(a,i){if(1&a&&(t.Gf(v.NW,5),t.Gf(_.YE,5),t.Gf(l.BZ,5),t.Gf(P.g5,5)),2&a){let r;t.iGM(r=t.CRH())&&(i.paginator=r.first),t.iGM(r=t.CRH())&&(i.sort=r.first),t.iGM(r=t.CRH())&&(i.table=r.first),t.iGM(r=t.CRH())&&(i.tableSearchField=r.first)}},inputs:{projectId:"projectId",userId:"userId",statusId:"statusId",priorityId:"priorityId"},features:[t.TTD],decls:39,vars:8,consts:[[1,"container"],[3,"loading$"],["hint","Insira o nome do projeto que deseja localizar",3,"search"],["mat-table","","matSort","","aria-label","Elements",1,"mat-elevation-z8","full-width-table"],["matColumnDef","checkbox"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","","colspan","6",4,"matFooterCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","status_id"],["matColumnDef","priority_id"],["matColumnDef","user_id"],["matColumnDef","effective_duration"],["mat-footer-cell","","colspan","2",4,"matFooterCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"dblclick",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["aria-label","Select page",1,"mat-elevation-z8",3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],["mat-header-cell",""],["mat-cell",""],[3,"checked","click"],["mat-footer-cell","","colspan","6"],["mat-header-cell","","mat-sort-header",""],["mat-footer-cell","","colspan","2"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["matSuffix",""],["mat-header-row",""],["mat-row","",3,"dblclick"],["mat-footer-row",""]],template:function(a,i){1&a&&(t.TgZ(0,"div",0),t._UZ(1,"app-loading-spinner",1),t.TgZ(2,"app-table-search-field",2),t.NdJ("search",function(s){return i.search(s)}),t.qZA(),t.TgZ(3,"table",3),t.ynx(4,4),t.YNc(5,St,1,0,"th",5),t.YNc(6,yt,2,1,"td",6),t.YNc(7,wt,2,0,"td",7),t.BQk(),t.ynx(8,8),t.YNc(9,kt,2,0,"th",9),t.YNc(10,At,2,1,"td",6),t.BQk(),t.ynx(11,10),t.YNc(12,Ft,2,0,"th",9),t.YNc(13,Ut,2,1,"td",6),t.BQk(),t.ynx(14,11),t.YNc(15,It,2,0,"th",9),t.YNc(16,Dt,2,1,"td",6),t.BQk(),t.ynx(17,12),t.YNc(18,Nt,2,0,"th",9),t.YNc(19,Pt,2,1,"td",6),t.BQk(),t.ynx(20,13),t.YNc(21,Et,2,0,"th",9),t.YNc(22,qt,2,1,"td",6),t.BQk(),t.ynx(23,14),t.YNc(24,Yt,2,0,"th",9),t.YNc(25,Gt,2,1,"td",6),t.BQk(),t.ynx(26,15),t.YNc(27,Qt,2,0,"th",9),t.YNc(28,Ot,2,1,"td",6),t.YNc(29,Rt,2,1,"td",16),t.BQk(),t.ynx(30,17),t._UZ(31,"th"),t.YNc(32,Jt,2,0,"th",9),t.YNc(33,Lt,2,1,"td",6),t.BQk(),t.YNc(34,Bt,1,0,"tr",18),t.YNc(35,zt,1,0,"tr",19),t.YNc(36,$t,1,0,"tr",20),t.qZA(),t._UZ(37,"mat-paginator",21,22),t.qZA()),2&a&&(t.xp6(1),t.Q6J("loading$",i.dataSource.loading$),t.xp6(33),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("matFooterRowDef",i.displayedColumnsFooter),t.xp6(1),t.Q6J("length",i.dataSource.getCount())("pageIndex",0)("pageSize",10)("pageSizeOptions",i.pageSizeOptions))},dependencies:[h.O5,Z.lW,J.Hw,f.R9,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.mD,l.Ke,l.ge,l.ev,l.yh,l.XQ,l.Gk,l.Q2,v.NW,_.YE,_.nU,jt.oG,M.g,w.g],styles:[".container[_ngcontent-%COMP%]{padding-top:20px}.full-width-table[_ngcontent-%COMP%]{width:96%;margin:20px auto 0}mat-paginator[_ngcontent-%COMP%]{width:100%;margin:0 auto 20px}.mat-column-id[_ngcontent-%COMP%], .mat-column-checkbox[_ngcontent-%COMP%]{width:75px}.mat-column-actions[_ngcontent-%COMP%]{min-width:130px}.mat-column-description[_ngcontent-%COMP%]{min-width:250px}.mat-mdc-footer-row[_ngcontent-%COMP%]{font-weight:700}"]})}return e})();function Ht(e,n){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Oqu(o.project.description)}}function Vt(e,n){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij(" - Dura\xe7\xe3o Estimada: ",o.project.estimated_duration," minutos ")}}const Xt=[{path:"",component:bt},{path:":id",component:(()=>{class e{constructor(o,a,i,r,s){this.route=o,this.dialog=a,this.projectService=i,this.taskService=r,this.authService=s,this.project=new T,this.task=new x,this.loadingSubject=new C.X(!1),this.isLoading$=this.loadingSubject.asObservable(),this.addButtonLabel="Adicionar Tarefa"}ngOnInit(){this.route.params.subscribe(o=>{this.routeParam=o.id,this.task.project_id=this.routeParam})}ngAfterViewInit(){setTimeout(()=>{this.getProjectById(this.routeParam),this.getCurrentUser()})}openCreateDialog(){console.log("openCreateDialog"),this.dialog.open(W,{width:"800px",data:this.task}).afterClosed().subscribe(a=>{a?.name&&(a.project_id=this.project.id,this.taskService.create(a).subscribe(i=>{this.task=new x,this.table.load()})),this.resetTask()})}resetTask(){this.task=new x,this.task.user_id=this.userId}getProjectById(o){this.loadingSubject.next(!0),this.projectService.getById(o).subscribe(a=>{this.project=a,this.loadingSubject.next(!1)})}getCurrentUser(){this.authService.getCurrentUser().subscribe(o=>{this.task.user_id=o.id})}onStatusSelectionChange(o){console.log(o),this.statusId=o.value}onStatusReset(o){console.log(o),this.statusId=void 0}onPrioritySelectionChange(o){console.log(o),this.priorityId=o.value}onPriorityReset(o){console.log(o),this.priorityId=void 0}onUserSelectionChange(o){console.log(o),this.userId=o.value}onUserReset(o){console.log(o),this.userId=void 0}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(g.gz),t.Y36(p.uw),t.Y36(y),t.Y36(K),t.Y36(S.e8))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-project-show"]],viewQuery:function(a,i){if(1&a&&t.Gf(tt,5),2&a){let r;t.iGM(r=t.CRH())&&(i.table=r.first)}},decls:23,vars:13,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutAlign","center","fxLayoutGap","10px","fxLayoutGap.xs","5px",1,"container"],[3,"loading$"],["fxFlex.gt-md","65","fxFlex.md","80","fxFlex","90"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","start end","fxLayoutGap","30px"],["fxFlex","20%"],["icon","add_task",1,"add-button",3,"buttonLabel","click"],[1,"container"],["fxLayout","row","fxLayoutAlign","center end","fxLayoutGap","30px"],["fxFlex","25%","fxFlexAlign","start start"],[3,"filtering","selectionChange","resetSelect"],["fxFlex","30%","fxFlexAlign","start send"],[3,"projectId","userId","statusId","priorityId"]],template:function(a,i){1&a&&(t.TgZ(0,"div",0),t._UZ(1,"app-loading-spinner",1),t.TgZ(2,"div",2)(3,"mat-card")(4,"mat-card-header")(5,"mat-card-title"),t._uU(6),t.qZA(),t.TgZ(7,"mat-card-subtitle"),t.YNc(8,Ht,2,1,"span",3),t.YNc(9,Vt,2,1,"span",3),t.qZA()(),t.TgZ(10,"mat-card-content")(11,"div",4)(12,"div",5)(13,"app-add-button",6),t.NdJ("click",function(){return i.openCreateDialog()}),t.qZA()()(),t.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"app-status-select",10),t.NdJ("selectionChange",function(s){return i.onStatusSelectionChange(s)})("resetSelect",function(s){return i.onStatusReset(s)}),t.qZA()(),t.TgZ(18,"div",9)(19,"app-priority-select",10),t.NdJ("selectionChange",function(s){return i.onPrioritySelectionChange(s)})("resetSelect",function(s){return i.onPriorityReset(s)}),t.qZA()(),t.TgZ(20,"div",11)(21,"app-user-select",10),t.NdJ("selectionChange",function(s){return i.onUserSelectionChange(s)})("resetSelect",function(s){return i.onUserReset(s)}),t.qZA()()(),t._UZ(22,"app-task-table",12),t.qZA()()()()()),2&a&&(t.xp6(1),t.Q6J("loading$",i.isLoading$),t.xp6(5),t.AsE("Projeto ",i.project.id," - ",i.project.name," "),t.xp6(2),t.Q6J("ngIf",i.project.description),t.xp6(1),t.Q6J("ngIf",i.project.estimated_duration),t.xp6(4),t.Q6J("buttonLabel",i.addButtonLabel),t.xp6(4),t.Q6J("filtering",!0),t.xp6(2),t.Q6J("filtering",!0),t.xp6(2),t.Q6J("filtering",!0),t.xp6(1),t.Q6J("projectId",i.project.id)("userId",i.userId)("statusId",i.statusId)("priorityId",i.priorityId))},dependencies:[h.O5,m.a8,m.dn,m.dk,m.$j,m.n5,d.xw,d.SQ,d.Wh,d.XD,d.yH,B.L,w.g,$.k,H.p,V.q,tt],styles:["mat-card-content[_ngcontent-%COMP%]{margin-top:20px}.container[_ngcontent-%COMP%]{padding-top:20px}"]})}return e})()}];let Wt=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[g.Bz.forChild(Xt),g.Bz]})}return e})(),Kt=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({imports:[h.ez,Wt,A.q,F.m,it]})}return e})()}}]);